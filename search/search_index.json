{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Blog","text":"<p>I'm working on a few articles. They will show up here once finished.</p>"},{"location":"scriptfu/","title":"ScriptFu","text":"<p>Here I have snippets of code and commands for my reference. Maybe others can find some things helpful as well. </p> <p>I will try to add official sources for documentation on each one of these pages (work in progress). Please, if you have found yourself here somehow and not already familiar, please take the time to follow the official documentation. This is more for ideas and examples.</p> <p>Two other better sources for examples are:</p> <ul> <li>cheat.sh Example, run:  <code>curl cht.sh/iptables</code></li> <li>tldr Example, run (once installed) <code>tldr nmap</code></li> </ul>"},{"location":"scriptfu/azure/aks/","title":"AKS","text":""},{"location":"scriptfu/azure/aks/#log-into-azure","title":"log into azure","text":"<pre><code>az login\n</code></pre>"},{"location":"scriptfu/azure/aks/#get-account-list-and-set","title":"get account list and set","text":"<pre><code>az account list -o table\naz account set --subscription '&lt;sub-name&gt;'\n</code></pre>"},{"location":"scriptfu/azure/aks/#get-aks-credentials-so-you-can-use-kubectl","title":"get aks credentials so you can use kubectl","text":"<pre><code>az aks list -o table\naz aks get-credentials --resource-group &lt;resource_grp&gt; --name &lt;name&gt;\n</code></pre>"},{"location":"scriptfu/azure/aks/#kubectl","title":"kubectl","text":"<pre><code>kubectl get namespace\nkubectl get nodes\nkubectl get services\nkubectl get pods --all-namespaces\nkubectl get sc\n</code></pre>"},{"location":"scriptfu/azure/aks/#storage","title":"storage","text":"<pre><code>kubectl get pvc -n &lt;pvcname&gt;\nkubectl get pv -n &lt;pvname&gt;\nkubectl describe pvc &lt;claimname&gt; -n &lt;namespace&gt;\n</code></pre>"},{"location":"scriptfu/azure/aks/#troubleshooting","title":"troubleshooting","text":"<pre><code>kubectl describe pods -n &lt;namespace&gt;\nkubectl logs &lt;logname&gt; -n &lt;namespace&gt;\nkubectl logs &lt;podname&gt; -n &lt;namespace&gt;\nkubectl exec --stdin --tty opensearch-cluster-master-0 -n &lt;namespace&gt; -- /bin/bash\ncurl --insecure -u admin:admin 'https://&lt;cluster&gt;:9200/_cat/indices?v'\n</code></pre>"},{"location":"scriptfu/azure/aks/#restart","title":"restart","text":"<pre><code>kubectl rollout restart deployment &lt;deployment&gt; -n &lt;namespace&gt;\nkubectl delete pod &lt;pod&gt; -n &lt;namespace&gt;\n</code></pre>"},{"location":"scriptfu/azure/asa_vpn/","title":"ASA VPN","text":""},{"location":"scriptfu/azure/asa_vpn/#vpn-connection-to-azure-from-asa","title":"vpn connection to azure from asa","text":"<p>azure-vpn-asa</p>"},{"location":"scriptfu/cisco/cisco_asa/","title":"Cisco ASA","text":""},{"location":"scriptfu/cisco/cisco_asa/#backup-asa-config","title":"backup asa config","text":"<pre><code>copy running-config disk0:/running-config_backup.txt\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#scp-config","title":"scp config","text":"<pre><code>scp -O &lt;host&gt;:disk0:running-config_backup.txt .\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#list-asa-users","title":"list asa users","text":"<pre><code>show running-config username\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#change-asa-passwords","title":"change asa passwords","text":"<pre><code>username &lt;username&gt; password &lt;password&gt; priv 15\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#debug","title":"Debug","text":""},{"location":"scriptfu/cisco/cisco_asa/#dap","title":"dap","text":"<pre><code>debug dap error\ndebug dap trace 2\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#site-to-site","title":"site-to-site","text":""},{"location":"scriptfu/cisco/cisco_asa/#ikev1","title":"IKEv1","text":"<pre><code>debug crypto condition peer X.X.X.X\ndebug crypto ikev1 200\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#ikev2","title":"IKEv2:","text":"<pre><code>debug crypto condition peer X.X.X.X\ndebug crypto ikev2 platform 100\ndebug crypto ikev2 protocol 100\n</code></pre>"},{"location":"scriptfu/cisco/cisco_asa/#show-conditions-so-we-can-remove","title":"show conditions so we can remove","text":"<pre><code>show debug\n</code></pre>"},{"location":"scriptfu/cisco/nexus/","title":"Nexus switches","text":""},{"location":"scriptfu/cisco/nexus/#find-port-device-is-plugged-into-by-ip","title":"Find port device is plugged into by IP.","text":"<pre><code>show ip arp x.x.x.x\nshow mac address-table | include &lt;mac&gt;\n</code></pre>"},{"location":"scriptfu/dell/perc/","title":"Dell PERC","text":""},{"location":"scriptfu/dell/perc/#disks","title":"disks","text":""},{"location":"scriptfu/dell/perc/#check-vdisks","title":"check vdisks","text":"<pre><code>omreport storage vdisk\n</code></pre>"},{"location":"scriptfu/dell/perc/#check-physical-disks-belonging-to-vdisk","title":"check physical disks belonging to vdisk","text":"<pre><code>omreport storage pdisk controller=0 vdisk=0\n</code></pre>"},{"location":"scriptfu/dell/perc/#check-all-physical-disks","title":"check all physical disks","text":"<pre><code>omreport storage pdisk controller=0\n</code></pre>"},{"location":"scriptfu/dell/perc/#blink-disk","title":"blink disk","text":"<pre><code>omconfig storage pdisk action=blink controller=0 pdisk=0:1:6\nomconfig storage pdisk action=unblink controller=0 pdisk=0:1:6\n</code></pre>"},{"location":"scriptfu/dell/perc/#find-available-slots","title":"find available slots","text":"<pre><code>omreport storage controller controller=0 info=pdslotreport\n</code></pre>"},{"location":"scriptfu/dell/perc/#clear-foreign-config","title":"clear foreign config","text":"<pre><code>omconfig storage controller action=clearforeignconfig controller=0\n</code></pre>"},{"location":"scriptfu/dell/perc/#discard-preserved-cache","title":"discard preserved cache","text":"<pre><code>omconfig storage controller action=discardpreservedcache controller=0 force=enabled\n</code></pre>"},{"location":"scriptfu/dell/perc/#create-new-morrored-vdisk","title":"create new morrored vdisk","text":"<pre><code>omconfig storage controller action=createvdisk controller=0 raid=r1 size=max pdisk=\"0:1:6,0:1:7\"\nomconfig storage controller action=createvdisk controller=0 raid=r1 size=max pdisk=\"0:1:0,0:1:7\"\n</code></pre>"},{"location":"scriptfu/docker/create/","title":"docker app","text":""},{"location":"scriptfu/docker/create/#build-image","title":"build image","text":"<pre><code>docker build -t &lt;tagname&gt; .\n</code></pre>"},{"location":"scriptfu/docker/create/#run-image-temporarily","title":"run image temporarily","text":"<pre><code>sudo docker run --rm -it -p 8080:5000 --name spyglass-frontend &lt;tagname&gt;\n</code></pre>"},{"location":"scriptfu/docker/manage/","title":"manage","text":""},{"location":"scriptfu/docker/manage/#get-shell-on-docker-container","title":"get shell on docker container","text":"<pre><code>docker exec -it &lt;container_id&gt; sh\n</code></pre>"},{"location":"scriptfu/docker/manage/#start-new-container-in-daemon-mode","title":"start new container in daemon mode","text":"<pre><code>docker run -d -p 8082:5000 --name &lt;name&gt; &lt;image&gt;\n</code></pre>"},{"location":"scriptfu/docker/manage/#rename-container","title":"rename container","text":"<pre><code>docker rename &lt;target&gt; &lt;new_name&gt;\n</code></pre>"},{"location":"scriptfu/docker/manage/#modify-restart-policy","title":"modify restart policy","text":"<pre><code>docker update --restart unless-stopped &lt;container&gt;\n</code></pre>"},{"location":"scriptfu/git/remote_bare_repo/","title":"Remote bare repo","text":""},{"location":"scriptfu/git/remote_bare_repo/#make-a-new-bare-repo","title":"Make a new bare repo","text":"<pre><code>ssh &lt;username&gt;@&lt;host&gt; 'git init --bare ~/git/dotfiles.git'\n</code></pre>"},{"location":"scriptfu/git/remote_bare_repo/#push-to-the-new-repo","title":"Push to the new repo","text":"<pre><code>git push &lt;username&gt;@&lt;host&gt;:~/git/dotfiles main\n</code></pre>"},{"location":"scriptfu/jenkins/cleanup/","title":"cleanup","text":""},{"location":"scriptfu/jenkins/cleanup/#kill-jobs","title":"kill jobs","text":"<pre><code>import jenkins.model.Jenkins\n\ndef projectPath = \"&lt;project_path&gt;\"\n\nJenkins.instance.getAllItems(jenkins.model.ItemGroup).each { itemGroup -&gt;\n    if (itemGroup.fullName == projectPath) {\n        itemGroup.getAllItems().each { job -&gt;\n            println(\"Stopping job: ${job.fullName}\")\n            job.doStop()\n        }\n    }\n}\n</code></pre>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/","title":"acme.sh","text":"<p>Configs and certs can be found in <code>~/.acme.sh/</code></p>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/#upgrade-acmesh","title":"upgrade acme.sh","text":"<pre><code>acme.sh --upgrade\n</code></pre>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/#issue-first-certificate-using-he-dns","title":"issue first certificate using he dns","text":"<pre><code>acme.sh --issue -d abnml.com -d '*.abnml.com' --dns dns_he --server letsencrypt\n</code></pre>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/#install-cronjob","title":"install cronjob","text":"<pre><code>acme.sh --install-cronjob\n</code></pre>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/#list-certs-and-dates","title":"list certs and dates","text":"<pre><code>acme.sh --list\n</code></pre>"},{"location":"scriptfu/letsencrypt/acmesh_freebsd/#set-notifications","title":"set notifications","text":"<pre><code>acme.sh --set-notify --notify-hook mailgun --notify-level 2 --notify-mode 0\n</code></pre>"},{"location":"scriptfu/letsencrypt/certbot_debian/","title":"certbot debian","text":""},{"location":"scriptfu/letsencrypt/certbot_debian/#create-txt-record-on-hurricane-electric","title":"Create TXT record on hurricane electric","text":"<pre><code>_acme-challenge.abnml.com\n</code></pre>"},{"location":"scriptfu/letsencrypt/certbot_debian/#install-certbot-on-debian-12","title":"Install certbot on Debian 12","text":"<pre><code>sudo snap install --classic certbot\nsudo snap set certbot trust-plugin-with-root=ok\nsudo snap install certbot-dns-multi\nsudo snap connect certbot:plugin certbot-dns-multi\n</code></pre>"},{"location":"scriptfu/letsencrypt/certbot_debian/#create-etcletsencryptdns-multiini-file","title":"Create <code>/etc/letsencrypt/dns-multi.ini</code> file","text":"<pre><code>dns_multi_provider = hurricane\nHURRICANE_TOKENS=abnml.com:&lt;token&gt;\n</code></pre>"},{"location":"scriptfu/letsencrypt/certbot_debian/#update-permissions-on-dns-multiini","title":"Update permissions on <code>dns-multi.ini</code>","text":"<pre><code>sudo chmod go-r /etc/letsencrypt/dns-multi.ini\n</code></pre>"},{"location":"scriptfu/letsencrypt/certbot_debian/#request-certonly","title":"Request certonly","text":"<pre><code>sudo /snap/bin/certbot certonly -a dns-multi --dns-multi-credentials=/etc/letsencrypt/dns-multi.ini -d \"abnml.com\" -d \"*.abnnml.com\"\n</code></pre>"},{"location":"scriptfu/letsencrypt/certificates/","title":"certificates","text":""},{"location":"scriptfu/letsencrypt/certificates/#read-certificate","title":"read certificate","text":"<pre><code>openssl x509 -text -noout -in certificate.crt\n</code></pre>"},{"location":"scriptfu/letsencrypt/certificates/#small-script-to-view-information-about-cert","title":"small script to view information about cert","text":"<pre><code>#!/usr/bin/env sh\n\nurl=$1\n\nif [ -z \"${url}\" ]; then\n  echo \"You need to provide a url\"\n  exit 1\nfi\n\necho | openssl s_client -showcerts -servername \"$url\" -connect \"$url\":443 2&gt;/dev/null | openssl x509 -inform pem -noout -text\n</code></pre>"},{"location":"scriptfu/macos/key_swap/","title":"Modifier key swap","text":""},{"location":"scriptfu/macos/key_swap/#swap-modifier-keys-on-external-pc-keyboard","title":"Swap modifier keys on external PC keyboard","text":"<p>This is to swap the Alt and Super keys on a PC keyboard to make it behave like a mac keyboard. </p>"},{"location":"scriptfu/mysql/user_admin/","title":"user admin","text":""},{"location":"scriptfu/mysql/user_admin/#set-root-password","title":"set root password","text":"<pre><code>UPDATE mysql.user SET password = PASSWORD('newpassword') WHERE user = 'root';\n</code></pre>"},{"location":"scriptfu/mysql/user_admin/#disable-auth-plugin","title":"disable auth plugin","text":"<pre><code>sudo mysql -u root\n[mysql] use mysql;\n[mysql] update user set plugin='' where User='root';\n[mysql] flush privileges;\n[mysql] \\q\n</code></pre>"},{"location":"scriptfu/networking/ethernet_cable/","title":"ethernet cable wiring","text":""},{"location":"scriptfu/networking/osi/","title":"OSI model","text":""},{"location":"scriptfu/python/netbox/","title":"netbox","text":""},{"location":"scriptfu/python/netbox/#search-for-devices-in-shell","title":"search for devices in shell","text":"<pre><code>import pynetbox\n\nnb = pynetbox.api('https://netboxurl&gt;', token=\"&lt;token&gt;\")\n\ndevices = nb.dcim.devices.filter(site=\"&lt;site&gt;\", tenant=[\"&lt;tenant&gt;\"], status=[\"offline\", \"active\"])\n\nlen(devices)\n\nfor device in devices:\n    print(f\"{device.id},{device.name}\")\n</code></pre>"},{"location":"scriptfu/unix/","title":"unix","text":""},{"location":"scriptfu/unix/#display-csv-or-other-data-and-format-it-nicely","title":"Display csv or other data and format it nicely","text":"<pre><code>cat data.csv | column -t -s, | less -S\n</code></pre>"},{"location":"scriptfu/unix/apcupsd/","title":"apcupsd","text":""},{"location":"scriptfu/unix/apcupsd/#view-apc-battery-status","title":"View apc battery status","text":"<pre><code>apcaccess status\n</code></pre>"},{"location":"scriptfu/unix/apcupsd/#basic-config-file","title":"Basic config file","text":"<pre><code>## apcupsd.conf v1.1 ##\n#UPSNAME\nUPSCABLE usb\nUPSTYPE usb\n#POLLTIME 60\nLOCKFILE /var/spool/lock\nSCRIPTDIR /usr/local/etc/apcupsd\nPWRFAILDIR /var/run\nNOLOGINDIR /var/run\nONBATTERYDELAY 6\nBATTERYLEVEL 5\nMINUTES 3\nTIMEOUT 0\nANNOY 300\nANNOYDELAY 60\nNOLOGON disable\nKILLDELAY 0\nNETSERVER on\nNISIP 0.0.0.0\nNISPORT 3551\nEVENTSFILE /var/log/apcupsd.events\nEVENTSFILEMAX 10\nUPSCLASS standalone\nUPSMODE disable\nSTATTIME 0\nSTATFILE /var/log/apcupsd.status\nLOGSTATS off\nDATATIME 0\nSENSITIVITY M\n</code></pre>"},{"location":"scriptfu/unix/borg/","title":"borg backup","text":""},{"location":"scriptfu/unix/borg/#init-a-new-backup","title":"init a new backup","text":"<pre><code>borg init --encryption=repokey &lt;user&gt;@&lt;server&gt;:/&lt;backupdir&gt;/&lt;computer&gt;\n</code></pre>"},{"location":"scriptfu/unix/borg/#manually-create-a-first-init-backup-with-stats-and-progress","title":"manually create a first init backup with stats and progress","text":"<pre><code>borg create -s --progress &lt;user&gt;@&lt;server&gt;:/&lt;backupdir&gt;/&lt;computer&gt;::initial ~\n</code></pre>"},{"location":"scriptfu/unix/dd/","title":"dd","text":""},{"location":"scriptfu/unix/dd/#create-a-large-junk-file","title":"create a large junk file","text":"<pre><code>dd if=/dev/zero of=junkfile.img bs=1 count=0 seek=1G\n</code></pre>"},{"location":"scriptfu/unix/iperf3/","title":"iperf3","text":"<p>Perform network throughput tests.</p> <ul> <li>iperf3 manpage</li> </ul>"},{"location":"scriptfu/unix/iperf3/#set-up-a-server","title":"set up a server","text":"<pre><code>iperf3 -s -p 30001\n</code></pre>"},{"location":"scriptfu/unix/iperf3/#connect-with-client","title":"connect with client","text":"<pre><code>iperf3 -c &lt;host&gt; -p 30001\n</code></pre>"},{"location":"scriptfu/unix/logs/","title":"Logs","text":""},{"location":"scriptfu/unix/logs/#send-a-test-log-message","title":"send a test log message","text":"<pre><code>nc -w0 -u 192.168.0.1 514 &lt;&lt;&lt; \"testing log message\"\n</code></pre>"},{"location":"scriptfu/unix/mbuffer/","title":"mbuffer","text":"<p>The fastest way to send data from one zfs dataset to another.</p>"},{"location":"scriptfu/unix/mbuffer/#receive","title":"receive","text":"<pre><code>sudo mbuffer -4 -s 128k -m 1G -I 9090 | sudo zfs receive -F hellcat/books\n</code></pre>"},{"location":"scriptfu/unix/mbuffer/#send","title":"send","text":"<pre><code>sudo zfs send -R tank/books@test | mbuffer -s 128k -m 1G -O 192.168.80.12:9090\n</code></pre>"},{"location":"scriptfu/unix/mbuffer/#example-output","title":"Example output","text":"<pre><code>in @  0.0 kiB/s, out @  458 MiB/s, 71.3 GiB total, buffer  14% full\nsummary: 71.5 GiByte in  2min 48.8sec - average of  434 MiB/s\n</code></pre>"},{"location":"scriptfu/unix/nginx/","title":"nginx","text":""},{"location":"scriptfu/unix/nginx/#host-a-static-site","title":"host a static site","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    server_name wiki.br.abnml.com;\n    return 301 https://wiki.br.abnml.com$request_uri$is_args$args;\n}\n\nserver {\n    listen 443 ssl;\n    server_name wiki.br.abnml.com;\n    ssl_certificate /etc/letsencrypt/live/wiki.br.abnml.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/wiki.br.abnml.com/privkey.pem;\n    ssl_trusted_certificate /etc/letsencrypt/live/wiki.br.abnml.com/chain.pem;\n    access_log /var/log/nginx/wiki.br.abnml.com.access.log;\n    error_log /var/log/nginx/wiki.br.abnml.com.error.log;\n    root /srv/www/wiki.br.abnml.com/public_html;\n\n    error_page 404 /srv/www/wiki.br.abnml.com/public_html/404.html;\n}\n</code></pre>"},{"location":"scriptfu/unix/nmap/","title":"nmap","text":""},{"location":"scriptfu/unix/nmap/#quick-portscan-of-a-subnet-and-display-readably-on-terminal","title":"quick portscan of a subnet and display readably on terminal","text":"<pre><code>nmap -sn 192.168.1.0/24 -oG -\n</code></pre>"},{"location":"scriptfu/unix/nmap/#identify-service-on-port","title":"identify service on port","text":"<pre><code>nmap -sV -p80 192.168.1.1\n</code></pre>"},{"location":"scriptfu/unix/nmap/#identify-os","title":"identify OS","text":"<pre><code>sudo nmap -O 192.168.1.1\n</code></pre>"},{"location":"scriptfu/unix/nmap/#uses-vulscan-script-to-check-target-services-for-vulnerabilities","title":"uses vulscan script to check target services for vulnerabilities.","text":"<pre><code>alias nmap_check_for_vulns=\"nmap --script=vuln\"\n</code></pre>"},{"location":"scriptfu/unix/ssh/","title":"SSH","text":""},{"location":"scriptfu/unix/ssh/#diff-over-ssh","title":"diff over ssh","text":"<pre><code>diff foo &lt;(ssh server 'cat foo')\ndiff &lt;(ssh server1 'cat foo') &lt;(ssh server2 'cat foo')\n</code></pre>"},{"location":"scriptfu/unix/ssh/#poor-mans-ssh-tunnel","title":"poor mans ssh tunnel","text":"<pre><code>&lt;local port&gt; &lt;target&gt; &lt;remote port&gt; &lt;bastion&gt;\nssh -L 8000:example.com:443 mybastionhost.com\n</code></pre>"},{"location":"scriptfu/unix/tcpdump/","title":"tcpdump","text":""},{"location":"scriptfu/unix/tcpdump/#listen-for-icmp-traffic","title":"listen for icmp traffic","text":"<pre><code>tcpdump -i eth0 icmp\n</code></pre>"},{"location":"scriptfu/unix/tcpdump/#check-a-port","title":"check a port","text":"<pre><code>tcpdump -i any port 25\n</code></pre>"},{"location":"scriptfu/unix/weechat/","title":"weechat","text":""},{"location":"scriptfu/unix/weechat/#set-autojoin-channels","title":"set autojoin channels","text":"<pre><code>/autojoin apply\n/layout store\n/save\n</code></pre>"},{"location":"scriptfu/unix/weechat/#change-buffer-notify-level","title":"change buffer notify level","text":"<pre><code>/buffer notify [level]\n/buffer notify highlight\n/buffer notify messages\n</code></pre>"},{"location":"scriptfu/unix/weechat/#change-buffer","title":"change buffer","text":"<pre><code>/buffer [#]\n</code></pre>"},{"location":"scriptfu/unix/weechat/#fix-alt-key-on-iterm2","title":"fix alt key on iTerm2","text":"<pre><code>Preferences-&gt;Profiles-&gt;Keys and click +Esc radio button for option keys.\n</code></pre>"},{"location":"scriptfu/unix/wget/","title":"wget","text":""},{"location":"scriptfu/unix/wget/#options","title":"options","text":"<pre><code>-r recursive\n-l7 level depth\n-np no parent\n-nH no host directories\n--cut-dirs=1 ignore directories\n-A acceptlist of file types to download\n--no-verbose clean up some of the noise\n</code></pre>"},{"location":"scriptfu/unix/wget/#fetch-pdfs-and-xlsx-files-recursively-from-site","title":"Fetch PDFS and XLSX files recursively from site","text":"<pre><code>wget -r -l7 -np -nH --cut-dirs=1 -A \"*.pdf, *.xlsx\" https://&lt;somewebsite&gt;/ --no-verbose\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/","title":"bhyve","text":""},{"location":"scriptfu/unix/freebsd/bhyve/#create-vm","title":"create vm","text":"<pre><code>sudo vm create &lt;vmname&gt;\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#transfer-proxmox-raw-image","title":"transfer proxmox raw image","text":"<pre><code>sudo dd if=/dev/mapper/pve-vm--100--disk--0 bs=1M | ssh beefcake 'dd of=/hellcat/backup/rstudio.img'\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#list-vms","title":"list vms","text":"<pre><code>sudo vm list\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#get-console","title":"get console","text":"<pre><code>sudo vm console rstudiotest\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#exit-console","title":"exit console","text":"<pre><code>~ + Ctrl-D\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#check-partition-of-disk","title":"check partition of disk","text":""},{"location":"scriptfu/unix/freebsd/bhyve/#make-vnode","title":"make vnode","text":"<pre><code>sudo mdconfig -a -t vnode -u 0 -f /hellcat/bhyve/rstudiotest/disk0.img\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#detach","title":"detach","text":"<pre><code>sudo mdconfig -d -u /dev/md0\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#find-device","title":"find device","text":"<pre><code>sudo mdconfig -l\n</code></pre>"},{"location":"scriptfu/unix/freebsd/bhyve/#list-partitions","title":"list partitions","text":"<pre><code>sudo fdisk md0\ngpart list md0\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disable_power_button/","title":"Disable power button","text":""},{"location":"scriptfu/unix/freebsd/disable_power_button/#disable-power-button","title":"disable power button","text":"<pre><code>sysctl hw.acpi.power_button_state=NONE\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disable_power_button/#add-to-etcsysctlconf","title":"add to <code>/etc/sysctl.conf</code>","text":"<pre><code>hw.acpi.power_button_state=NONE\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disks/","title":"disks","text":""},{"location":"scriptfu/unix/freebsd/disks/#list-disks","title":"list disks","text":"<pre><code>geom disk list\ncamcontrol devlist\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disks/#find-serial","title":"find serial","text":"<pre><code>sudo camcontrol identify /dev/da7 | grep serial\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disks/#monitor-disk-io","title":"monitor disk i/o","text":"<pre><code>gstat\niostat\n</code></pre>"},{"location":"scriptfu/unix/freebsd/disks/#show-controller-info","title":"show controller info","text":"<pre><code>sudo mpsutil show all\n</code></pre>"},{"location":"scriptfu/unix/freebsd/motd/","title":"motd","text":"<p>I takes more than just modifying <code>/etc/motd</code> on a freebsd system now to modify the motd. You need to modify the template file then restart the service. During system startup, the kernel  version is prepended to <code>/etc/motd.template</code> and then written to <code>/var/run/motd</code>.</p>"},{"location":"scriptfu/unix/freebsd/motd/#update-the-motd","title":"Update the motd","text":"<ul> <li>edit <code>/etc/motd.template</code></li> </ul>"},{"location":"scriptfu/unix/freebsd/motd/#restart-the-motd-service","title":"restart the motd service","text":"<pre><code>service motd restart\n</code></pre>"},{"location":"scriptfu/unix/freebsd/pf/","title":"pf","text":""},{"location":"scriptfu/unix/freebsd/pf/#view-ssh-blacklist","title":"view ssh blacklist","text":"<pre><code>blacklistctl dump -b\n</code></pre>"},{"location":"scriptfu/unix/freebsd/user_management/","title":"user management","text":""},{"location":"scriptfu/unix/freebsd/user_management/#create-service-account","title":"create service account","text":"<pre><code>sudo pw adduser proxmox -u 1005 -s /usr/sbin/nologin\n</code></pre>"},{"location":"scriptfu/unix/freebsd/user_management/#create-sftp-only-user","title":"create sftp only user","text":"<pre><code>adduser &lt;username&gt;\npw groupmod sftpdump -m &lt;username&gt;\npw usermod &lt;username&gt; -s /sbin/nologin\n</code></pre>"},{"location":"scriptfu/unix/linux/disable_power_button/","title":"Disable power button","text":""},{"location":"scriptfu/unix/linux/disable_power_button/#edit-etcsystemdlogindconf","title":"Edit <code>/etc/systemd/logind.conf</code>","text":"<pre><code># update HandlePowerKey to \"ignore\"\nHandlePowerKey=ignore\n</code></pre>"},{"location":"scriptfu/unix/linux/disable_power_button/#restart-systemd-logind","title":"Restart systemd-logind","text":"<pre><code>sudo systemctl restart systemd-logind\n</code></pre>"},{"location":"scriptfu/unix/linux/fans/","title":"fans","text":""},{"location":"scriptfu/unix/linux/fans/#view-sensor-data","title":"view sensor data","text":"<pre><code>sensors\n</code></pre>"},{"location":"scriptfu/unix/linux/fans/#detect-sensors","title":"detect sensors","text":"<pre><code>sensors-detect\n</code></pre>"},{"location":"scriptfu/unix/linux/fans/#configure-pwm-control","title":"configure pwm control","text":"<pre><code>pwmconfig\n</code></pre>"},{"location":"scriptfu/unix/linux/fans/#front-two-fans-on-headroom","title":"front two fans on headroom","text":"<pre><code>Testing pwm control hwmon5/pwm2 ...\n  hwmon5/fan2_input ... speed was 2268 now 1161\n    It appears that fan hwmon5/fan2_input\n    is controlled by pwm hwmon5/pwm2\n</code></pre>"},{"location":"scriptfu/unix/linux/iptables/","title":"iptables","text":""},{"location":"scriptfu/unix/linux/iptables/#list-rules-with-line-numbers","title":"list rules with line numbers","text":"<pre><code>sudo iptables --list --line-numbers\n</code></pre>"},{"location":"scriptfu/unix/linux/iptables/#delete-a-rule-with-number","title":"delete a rule with number","text":"<pre><code>sudo iptables -D INPUT &lt;number&gt;\n</code></pre>"},{"location":"scriptfu/unix/linux/iptables/#add-an-input-rule","title":"add an input rule","text":"<pre><code>sudo iptables -A INPUT -p tcp --dport 25 -j ACCEPT\n</code></pre>"},{"location":"scriptfu/unix/linux/iptables/#only-allow-communication-when-connected-to-vpn","title":"only allow communication when connected to VPN","text":"<pre><code>iptables config to prevent communication unless connected to a VPN.\n&lt;sxh&gt;\n#!/bin/sh\n\nIPT=\"/sbin/iptables\"\n\n# Allow loopback device\n$IPT -A INPUT -i lo -j ACCEPT\n$IPT -A OUTPUT -o lo -j ACCEPT\n\n# Allow all local traffic.\n$IPT -A INPUT -s 192.168.81.0/24 -j ACCEPT\n$IPT -A OUTPUT -d 192.168.81.0/24 -j ACCEPT\n$IPT -A INPUT -s 10.0.81.0/24 -j ACCEPT\n$IPT -A OUTPUT -d 10.0.81.0/24 -j ACCEPT\n\n# Allow VPN establishment\n$IPT -A OUTPUT -p udp --dport 1194 -j ACCEPT\n$IPT -A INPUT -p udp --sport 1194 -j ACCEPT\n\n# Accept all TUN connections (tun = VPN tunnel)\n$IPT -A OUTPUT -o tun+ -j ACCEPT\n$IPT -A INPUT -i tun+ -j ACCEPT\n\n# Set default policies to drop all communication unless specifically allowed\n$IPT -P INPUT DROP\n$IPT -P OUTPUT DROP\n$IPT -P FORWARD DROP\n</code></pre>"},{"location":"scriptfu/unix/linux/nvidia/","title":"nvidia","text":""},{"location":"scriptfu/unix/linux/nvidia/#patch-nvidia-card-for-multiple-streams","title":"patch nvidia card for multiple streams","text":"<p>If the nvidia driver gets updated, you'll need to repatch the driver to unlock multiple nvenc. Code is at https://github.com/keylase/nvidia-patch/</p>"},{"location":"scriptfu/unix/linux/nvidia/#check-nvidia-driver-version","title":"Check nvidia driver version:","text":"<pre><code>nvidia-smi\n</code></pre>"},{"location":"scriptfu/unix/linux/nvidia/#apply-patch","title":"Apply patch:","text":"<pre><code>sudo /home/stevenix/opt/nvidia-patch/patch.sh\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/","title":"User admin","text":""},{"location":"scriptfu/unix/linux/user_admin/#add-new-user","title":"add new user","text":"<pre><code>useradd -m -G sudo -p &lt;password&gt; &lt;username&gt;\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/#add-new-service-account","title":"add new service account","text":"<pre><code>sudo useradd --system --no-create-home ampache\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/#add-new-user-with-custom-home-dir","title":"add new user with custom home dir","text":"<pre><code>sudo useradd -m -d /opt/username username\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/#add-user-to-group","title":"add user to group","text":"<pre><code>sudo usermod -a -G media pi\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/#make-a-new-group-with-gid","title":"make a new group with gid","text":"<pre><code>sudo groupadd -g 1010 media\n</code></pre>"},{"location":"scriptfu/unix/linux/user_admin/#run-as-another-user-that-has-binnologin-set","title":"run as another user that has /bin/nologin set","text":"<pre><code>su -m &lt;user&gt; -c \"&lt;command&gt;\"\n</code></pre>"},{"location":"scriptfu/unix/zfs/new_disk_linux/","title":"new disk (linux)","text":""},{"location":"scriptfu/unix/zfs/new_disk_linux/#install-parted","title":"install parted","text":"<pre><code>apt install parted\n</code></pre>"},{"location":"scriptfu/unix/zfs/new_disk_linux/#this-will-give-us-partprobe-so-we-can-have-linux-rescan-disks","title":"this will give us 'partprobe' so we can have linux rescan disks","text":"<pre><code>partprobe\n</code></pre>"},{"location":"scriptfu/unix/zfs/new_disk_linux/#check-out-disk-id","title":"check out disk id","text":"<pre><code>ls -lh /dev/disk/by-id\n</code></pre>"},{"location":"scriptfu/unix/zfs/new_disk_linux/#set-gpt-table","title":"set GPT table","text":"<pre><code>sudo parted /dev/disk/by-id/&lt;disk&gt;\n(parted) mklabel GPT\n</code></pre>"},{"location":"scriptfu/unix/zfs/new_disk_linux/#view-disks-by-id","title":"view disks by ID","text":"<pre><code>ls /dev/disk/by-id\n</code></pre>"},{"location":"scriptfu/unix/zfs/timemachine/","title":"timemachine","text":"<p>Configure time machine on server first with smb</p>"},{"location":"scriptfu/unix/zfs/timemachine/#from-macos-configure-share-as-a-time-machine-location","title":"from macos configure share as a time machine location","text":"<pre><code>sudo tmutil setdestination smb://&lt;username&gt;:&lt;password&gt;@&lt;server&gt;/&lt;dir&gt;\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/","title":"zfs command","text":""},{"location":"scriptfu/unix/zfs/zfs/#properties","title":"properties","text":""},{"location":"scriptfu/unix/zfs/zfs/#get-all-properties","title":"get all properties","text":"<pre><code>zfs get all tank\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#snapshots","title":"snapshots","text":""},{"location":"scriptfu/unix/zfs/zfs/#list-snapshots","title":"list snapshots","text":"<pre><code>zfs list -t snapshot\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#create-new-snapshot","title":"create new snapshot","text":"<pre><code>sudo zfs snapshot -r tank@&lt;snapshotname&gt;\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#datasets","title":"datasets","text":""},{"location":"scriptfu/unix/zfs/zfs/#create-a-new-dataset","title":"create a new dataset","text":"<pre><code>sudo zfs create tank/home\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#change-mount-point-for-home-dir","title":"change mount point (for home dir)","text":"<pre><code>sudo zfs set mountpoint=/home/ tank/home\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#quotas","title":"quotas","text":""},{"location":"scriptfu/unix/zfs/zfs/#check-userquotas","title":"check userquotas","text":"<pre><code>sudo zfs userspace tank/home\nsudo zfs get userquota@username tank/home\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#set-quota","title":"set quota","text":"<pre><code>zfs set userquota@student1=10G students/compsci\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#share","title":"share","text":""},{"location":"scriptfu/unix/zfs/zfs/#list-shares","title":"list shares","text":"<pre><code>sudo zfs get sharenfs\n</code></pre>"},{"location":"scriptfu/unix/zfs/zfs/#set-shares","title":"set shares","text":"<pre><code>zfs set sharenfs='on,192.168.81.35' tank/downloads\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/","title":"zpool command","text":""},{"location":"scriptfu/unix/zfs/zpool/#new-pool","title":"new pool","text":""},{"location":"scriptfu/unix/zfs/zpool/#create-new-pool","title":"create new pool","text":"<pre><code>zpool create tank &lt;dev0&gt; &lt;dev1&gt;\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#add-a-new-vdev-to-existing-pool","title":"add a new vdev to existing pool","text":"<pre><code>zpool add tank raidz1 &lt;dev2&gt; &lt;dev3&gt;\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#get-general-status","title":"get general status","text":"<pre><code>zpool status\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#list-zpools","title":"list zpools","text":"<pre><code>zpool list\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#history","title":"history","text":""},{"location":"scriptfu/unix/zfs/zpool/#get-command-history","title":"get command history","text":"<pre><code>zpool history\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#user-initiated","title":"user initiated","text":"<pre><code>zpool history -i\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#long-format","title":"long format","text":"<pre><code>zpool history -l\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#scrubs","title":"scrubs","text":""},{"location":"scriptfu/unix/zfs/zpool/#start-scrub","title":"start scrub","text":"<pre><code>sudo zpool scrub tank\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#pause-scrub","title":"pause scrub","text":"<pre><code>sudo zpool scrub -s tank\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#replace-disks","title":"replace disks","text":""},{"location":"scriptfu/unix/zfs/zpool/#replace-a-disk","title":"replace a disk.","text":"<pre><code>sudo zpool replace &lt;poolname&gt; &lt;missing_guid&gt; &lt;new_dev&gt;\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#monitor-the-progress-of-the-resilvering-operation","title":"Monitor the progress of the resilvering operation","text":"<pre><code>zpool status -x\n</code></pre>"},{"location":"scriptfu/unix/zfs/zpool/#get-iostat","title":"get iostat","text":"<pre><code>zpool iostat tank 2\n</code></pre>"}]}